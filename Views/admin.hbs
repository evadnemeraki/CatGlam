<div id="panel" class="container-fluid no-gutters">
  <div class="row no-gutters">
    <div id="sidebar" class="gradb col-lg-2 col-md-3">
      <nav id="panelnav">
      <div id="saludo">{{message}}</div>
<ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" href="/panel">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
              Bandeja <span class="sr-only">(current)</span>
                        </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/panel/productos">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg>
              Productos
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
              Pedidos
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/panel/clientes">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
              Clientes
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
              Reportes
            </a>
          </li>
        </ul>
      </nav>
    </div>
    <div id="paneltablecontainer" class="col-lg-10 col-md-9 text-center">
        <div id="tablecenter">
            <div class="row no-gutters justify-content-between">
              {{#if stockwarning}}<div class="bd-callout bd-callout-info-low bg-light">
<h4 id="dealing-with-specificity">Productos con bajo stock <svg class="mb-1" width="24" height="24" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" width="512" height="512" viewBox="0 0 512.209 512.209" style="enable-background:new 0 0 512.209 512.209;" xml:space="preserve" class=""><g><g>
	<path d="M507.345,439.683L288.084,37.688c-3.237-5.899-7.71-10.564-13.429-13.988c-5.705-3.427-11.893-5.142-18.554-5.142   s-12.85,1.718-18.558,5.142c-5.708,3.424-10.184,8.089-13.418,13.988L4.859,439.683c-6.663,11.998-6.473,23.989,0.57,35.98   c3.239,5.517,7.664,9.897,13.278,13.128c5.618,3.237,11.66,4.859,18.132,4.859h438.529c6.479,0,12.519-1.622,18.134-4.859   c5.62-3.23,10.038-7.611,13.278-13.128C513.823,463.665,514.015,451.681,507.345,439.683z M292.655,411.132   c0,2.662-0.91,4.897-2.71,6.704c-1.807,1.811-3.949,2.71-6.427,2.71h-54.816c-2.474,0-4.616-0.899-6.423-2.71   c-1.809-1.807-2.713-4.042-2.713-6.704v-54.248c0-2.662,0.905-4.897,2.713-6.704c1.807-1.811,3.946-2.71,6.423-2.71h54.812   c2.479,0,4.62,0.899,6.428,2.71c1.803,1.807,2.71,4.042,2.71,6.704v54.248H292.655z M292.088,304.357   c-0.198,1.902-1.198,3.47-3.001,4.709c-1.811,1.238-4.046,1.854-6.711,1.854h-52.82c-2.663,0-4.947-0.62-6.849-1.854   c-1.908-1.243-2.858-2.807-2.858-4.716l-4.853-130.47c0-2.667,0.953-4.665,2.856-5.996c2.474-2.093,4.758-3.14,6.854-3.14h62.809   c2.098,0,4.38,1.043,6.854,3.14c1.902,1.331,2.851,3.14,2.851,5.424L292.088,304.357z" data-original="#000000" class="active-path" style="fill:#FFDD6F" data-old_color="#000000"></path>
</g></g> </svg></h4>
<p style="width: 80%; margin: auto auto;">Puede actualizar el ingreso de nueva mercadería directamente en la tabla debajo o en la sección <b>Productos</b> accesible desde la barra lateral.</p>
</div>
              {{else}}<div class="bd-callout bd-callout-info-ok bg-light">
<h4 id="dealing-with-specificity">No hay faltantes de stock</h4>
<p style="width: 80%; margin: auto auto;">Todos los productos cuentan con un stock superior a las 10 u.</p>
</div>
              {{/if}}

        {{#if stockwarning}}
        <table role="table" class="table table-bordered text-center">
        <thead role="rowgroup" class="bg-light">
          <tr role="row">
{{!-- If you change the table remember to update the data labels in the CSS file --}}
            <th role="columnheader" class="text-center" style="display: none;">Id</th>
            <th role="columnheader" class="text-center">Producto</th>
            <th role="columnheader" class="text-center">Descripción</th>
            <th role="columnheader" class="text-center">Categoría</th>
            <th role="columnheader" class="text-center">Precio</th>
            <th role="columnheader" class="text-center">Stock</th>
            <th role="columnheader" class="text-center">Imagen</th>
            <th role="columnheader" class="text-center">Acción</th>
          </tr>
        </thead>
        <tbody role="rowgroup">
          {{#each stockwarning}}
          <tr role="row">
            <td role="cell" style="display: none;">{{id_p}}</td>
            <td role="cell" contenteditable="true">{{nombre_p}}</td>
            <td role="cell" contenteditable="true">{{descripcion_p}}</td>
            <td role="cell">{{nombre_c}}</td>
            <td role="cell" contenteditable="true">{{precio_p}}</td>
            <td role="cell" contenteditable="true" class="text-danger font-weight-bold">{{stock_p}}</td>
            <td role="cell"><img src="{{imagen_p}}" style="width: 5rem;"></td>
            <td role="cell"> <!-- BOTÓN --><button type="button" class="btnSave btnfondo btn btn-verde btn-sm my-0 m-1">Guardar</button>
              <span class="table-remove"><button type="button" class="btnDelete btnborde btn btn-outline-danger btn-sm my-0"><a href="">Eliminar</a></button></span>
            </td>
          </tr>
          {{/each}}
        </tbody>
        </table>
        {{/if}}

            </div>
        </div>
      </div>
    </div>
  </div>
</div>

        <script>
          $('.table tbody').on('click', '.btnSave', function(){
            var currow = $(this).closest('tr');
            var id = currow.find('td:eq(0)').text();
            var nombre = currow.find('td:eq(1)').text();
            var descripcion = currow.find('td:eq(2)').text();
            var categoria = currow.find('td:eq(3)').text();
            var precio = currow.find('td:eq(4)').text();
            var stock = currow.find('td:eq(5)').text();
            var producto = {
              id, nombre, descripcion, categoria, precio, stock
            }
 
            $.ajax({
              type: "POST", url: "http://localhost:3000/panel/modificar/",
              cache: "false",contentType: "application/json",
              headers: {
                "Content-Type" : "application/json"
              },
              data:  JSON.stringify(producto),
             
            })

          })
          
        </script>

        <script>
          $('.table tbody').on('click', '.btnDelete', function(){
             var currow = $(this).closest('tr');
            var id = currow.find('td:eq(0)').text();

          $.ajax({
              type: "DELETE", url: "http://localhost:3000/panel/eliminar/"+id,
              cache: "false",contentType: "application/json",
              headers: {
                "Content-Type" : "application/json"
              }
            })
            })
        </script>