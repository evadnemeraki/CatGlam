<div id="panel" class="container-fluid no-gutters">
  <div class="row no-gutters">
    <div id="sidebar" class="gradb col-lg-2 col-md-3">
      <nav id="panelnav">
        <div class="row mt-2 justify-content-center">
          <div class="col-12 col-sm-6  col-md-12">
          <div class="fotoperfil" style="background-image:url({{fotoperfil}})"></div>
          </div>
          <div class="col-12 col-sm-6 col-md-12">
          <div id="saludo">{{message}} <svg onclick="document.getElementById('myModal3').style.display='block'" id="editsvg" width="1rem" height="1rem" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" width="512" height="512" viewBox="0 0 528.899 528.899" style="enable-background:new 0 0 528.899 528.899;" xml:space="preserve" class=""><g><g>
	<path d="M328.883,89.125l107.59,107.589l-272.34,272.34L56.604,361.465L328.883,89.125z M518.113,63.177l-47.981-47.981   c-18.543-18.543-48.653-18.543-67.259,0l-45.961,45.961l107.59,107.59l53.611-53.611   C532.495,100.753,532.495,77.559,518.113,63.177z M0.3,512.69c-1.958,8.812,5.998,16.708,14.811,14.565l119.891-29.069   L27.473,390.597L0.3,512.69z" data-original="#000000" class="active-path" data-old_color="#000000" style="fill:#FFFFFF"></path></g></g></svg onclick="document.getElementById('myModal3').style.display='block'">
          </div>
            <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="/panel">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
              Bandeja
                        </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/panel/productos">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline></svg>
              Productos <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
              Pedidos
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/panel/clientes">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
              Clientes
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/panel/blog">
              <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" height="512" viewBox="0 0 511 511.9996" width="512" class=""><g><path d="m444.464844 4.394531c-5.855469-5.859375-15.355469-5.859375-21.210938 0l-115.605468 115.605469h-262.148438c-24.8125 0-45 20.1875-45 45v209.996094c0 24.816406 20.1875 45 45 45h16v77c0 6.097656 3.691406 11.589844 9.335938 13.890625 5.726562 2.335937 12.183593.894531 16.386718-3.398438l85.585938-87.492187h174.691406c24.8125 0 45-20.183594 45-45v-170.144532l115.605469-115.605468c5.855469-5.859375 5.855469-15.355469 0-21.214844zm-137.886719 243.949219-42.425781-42.425781 127.28125-127.277344 42.425781 42.425781zm-58.40625-15.980469 31.960937 31.960938-54.78125 22.820312zm114.328125 142.632813c0 8.273437-6.730469 15-15 15h-181c-4.035156 0-7.902344 1.628906-10.722656 4.511718l-64.277344 65.707032v-55.21875c0-8.28125-6.714844-15-15-15h-31c-8.269531 0-15-6.726563-15-15v-209.996094c0-8.273438 6.730469-15 15-15h232.144531l-45.3125 45.3125c-1.25 1.25-2.488281 2.972656-3.3125 5.011719l-41.519531 99.675781h-81c-8.285156 0-15 6.714844-15 15 0 8.28125 6.714844 14.988281 15 14.988281h90.992188.011718c1.929688 0 4-.394531 5.894532-1.207031l108.773437-45.304688c1.8125-.707031 3.640625-1.9375 5.015625-3.3125l45.3125-45.3125zm92.570312-275.144532-42.425781-42.425781 21.214844-21.210937 42.425781 42.425781zm0 0" data-original="#000000" class="active-path" style="fill:#FFFFFF" data-old_color="#000000"></path></g> </svg>
                Blog
            </a>
          </li>
            </ul>
          </div>
        </div>
      </nav>
    </div>
    <div id="paneltablecontainer" class="col-lg-10 col-md-9 text-center">
      <div id="tablecenter">
        <div class="row no-gutters justify-content-between">
          <div>
            <button type="button" onclick="document.getElementById('myModal').style.display='block'" class="btn btn-celeste">+ Agregar producto</button>
            <button type="button" onclick="document.getElementById('myModal2').style.display='block'" class="btn btn-fucsia">+ Añadir Categoría</button>
          </div>
              <form  class="form-inline my-2 my-lg-0" method="GET" action="">
                <input class="form-control mr-sm-2" type="text" placeholder="Filtrar" name="text">
                <button class="btn btn-outline-secondary my-2 my-sm-0" type="submit">Filtrar</button>
              </form>
        </div>
        <table role="table" class="table text-center mt-2">
        <thead role="rowgroup" class="bg-light">
          <tr role="row">
{{!-- If you change the table remember to update the data labels in the CSS file --}}
            <th role="columnheader" class="text-center" style="display: none;">Id</th>
            <th role="columnheader" class="text-center">Producto</th>
            <th role="columnheader" class="text-center">Descripción</th>
            <th role="columnheader" class="text-center">Categoría</th>
            <th role="columnheader" class="text-center">Precio</th>
            <th role="columnheader" class="text-center">Stock</th>
            <th role="columnheader" class="text-center">Imagen</th>
            <th role="columnheader" class="text-center">Acción</th>
          </tr>
        </thead>
        <tbody role="rowgroup">
          {{#each productos}}
          <tr role="row">
            <td class="tdp" role="cell" style="display: none;">{{id_p}}</td c>
            <td class="tdp" role="cell" contenteditable="true">{{nombre_p}}</td>
            <td class="tdp" role="cell" contenteditable="true">{{descripcion_p}}</td>
            <td class="tdp" role="cell">{{nombre_c}}</td>
            <td class="tdp" role="cell" contenteditable="true">{{precio_p}}</td>
            <td class="tdp" role="cell" contenteditable="true">{{stock_p}}</td>
            <td class="tdp" role="cell"><img src="{{imagen_p}}" style="width: 5rem;"></td>
            <td class="tdp" role="cell"> <!-- BOTÓN --><button type="button" class="btnSave btnfondo btn btn-secondary btn-sm my-0 m-1">Guardar</button>
              <span class="table-remove"><button type="button" class="btnDelete btnborde btn btn-outline-danger btn-sm my-0"><a href="">Eliminar</a></button></span>
            </td>
          </tr>
          {{/each}}
        </tbody>
        </table>
<!-- The Add Product Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
<form role="form" action="productos/subir" method="POST">
  <div class="form-group">
    <label for="Producto">Producto: </label>
    <input class="form-control" name="producto" type="text" id="Producto">
  </div>
  <div class="form-group">
    <label for="Descripcion">Descripción: </label>
    <input class="form-control" name="descripcion" type="text" id="Descripcion">
  </div>
  <div class="form-group">
    <label for="Categoria">Categoría: </label>
    <select class="form-control" name="categoria" type="text" id="Categoria">
      {{#each categorias}}
      <option>{{nombre_c}}</option>
      {{/each}}
    </select>
  </div>
  <div class="form-group">
    <label for="Precio">Precio: </label>
    <input class="form-control" name="precio" type="text" id="Precio">
  </div>
  <div class="form-group">
    <label for="Stock">Stock: </label>
    <input class="form-control" name="stock" type="text" id="Stock">
  </div>
  <div class="form-group">
    <label for="Imagen">Imagen(URL): </label>
    <input class="form-control" name="imagen" type="text" id="Imagen">
  </div> 
<button type="submit" class="btnSave btn btn-secondary btn-rounded btn-sm my-0 m-1">Guardar</button>    
    </form>
  </div>
</div>


<!-- The Add Category Modal -->
<div id="myModal2" class="modal">

  <!-- Modal content-->
  <div class="modal-content">
    <span class="close2">&times;</span>
<form role="form" action="categorias/subir" method="POST">
  <div class="form-group">
    <label for="Producto">Nueva categoría: </label>
    <input class="form-control" name="ncategoria" type="text" id="ncategoria">
  </div>
<button type="submit" class="btnSave btn btn-secondary btn-rounded btn-sm my-0 m-1">Guardar</button>    
    </form>
  </div>
</div>

<script>
//Add Product > Get the modal
var modal = document.getElementById("myModal");
// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];
// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}
// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>

<script>
//Add Category > Get the modal
var modal2 = document.getElementById("myModal2");
// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close2")[0];
// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal2.style.display = "none";
}
</script>

        <script>
          $('.table tbody').on('click', '.btnSave', function(){
            var currow = $(this).closest('tr');
            var id = currow.find('td:eq(0)').text();
            var nombre = currow.find('td:eq(1)').text();
            var descripcion = currow.find('td:eq(2)').text();
            var categoria = currow.find('td:eq(3)').text();
            var precio = currow.find('td:eq(4)').text();
            var stock = currow.find('td:eq(5)').text();
            var producto = {
              id, nombre, descripcion, categoria, precio, stock
            }
 
            $.ajax({
              type: "POST", url: "http://localhost:3000/panel/modificar/",
              cache: "false",contentType: "application/json",
              headers: {
                "Content-Type" : "application/json"
              },
              data:  JSON.stringify(producto),
              statusCode: {
                200: function() {
                window.location.reload();
                }
              },
            })
          })
          
          
        </script>

        <script>
          $('.table tbody').on('click', '.btnDelete', function(){
             var currow = $(this).closest('tr');
            var id = currow.find('td:eq(0)').text();

          $.ajax({
              type: "DELETE", url: "http://localhost:3000/panel/eliminar/"+id,
              cache: "false",contentType: "application/json",
              headers: {
                "Content-Type" : "application/json"
              }
            })
            })
        </script>
      </div>
    </div>
  </div>
</div>
        {{> profilemodalA}}